  
  [1X1 [33X[0;0YQuillen-Suslin[133X[101X
  
  [33X[0;0YThe  algorithms  below  can  be used to reduce the number of generators of a
  module  over a polynomial ring. In particular, it can be used to find a free
  basis  of a free finitely presented module. The used references are [BLH11],
  [CLO05], [Fab08], [FQ07], [hpa13], [LW00].[133X
  
  
  [1X1.1 [33X[0;0YTool procedures[133X[101X
  
  [1X1.1-1 SuslinLemma[101X
  
  [33X[1;0Y[29X[2XSuslinLemma[102X( [3Xf[103X, [3Xg[103X, [3Xj[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ya [5Xhomalg[105X ring element[133X
  
  [33X[0;0YReturns  a  linear combination of [3Xf[103X and [3Xg[103X with leading coefficient being the
  [3Xj[103X-th coefficient of [3Xg[103X. [3Xf[103X has to be monic.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQ := HomalgFieldOfRationalsInSingular( );;[127X[104X
    [4X[25Xgap>[125X [27XR := ( Q * "x" ) * "y";[127X[104X
    [4X[28XQ[x][y][128X[104X
    [4X[25Xgap>[125X [27XAssignGeneratorVariables( R );[127X[104X
    [4X[28X#I  Assigned the global variables [ x, y ][128X[104X
    [4X[25Xgap>[125X [27Xf := x^2*y^4+23*x*y^5+y^6+7*x-y^2;;[127X[104X
    [4X[25Xgap>[125X [27Xg := (4*x*y^2+x^2+x^2*y-x*y^3);;[127X[104X
    [4X[25Xgap>[125X [27Xh := y^2 * g;;[127X[104X
    [4X[25Xgap>[125X [27XG := (4*x*y^2+x^2+2*y-x*y^3);;[127X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, g, 3 );[127X[104X
    [4X[28X[ -x^3*y^3-23*x^2*y^4-x*y^5+x^4*y+27*x^3*y^2+93*x^2*y^3+4*x*y^4+x^4+23*x^3*y+[128X[104X
    [4X[28X  x^2*y^2, 0, x^2+23*x*y+y^2 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, g, 2 );[127X[104X
    [4X[28X[ x^4*y^2+27*x^3*y^3+93*x^2*y^4+4*x*y^5+x^4*y+23*x^3*y^2+x^2*y^3-x*y^2+7*x^2,[128X[104X
    [4X[28X  x, x^2*y+23*x*y^2+y^3 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, g, 1 );[127X[104X
    [4X[28X[ x^4*y^3+23*x^3*y^4+x^2*y^5+x^4*y^2+23*x^3*y^3+x^2*y^4+6*x^2*y-29*x^2,[128X[104X
    [4X[28X  x*y-4*x, x^2*y^2+23*x*y^3+y^4-1 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, g, 0 );[127X[104X
    [4X[28X[ x^4*y^3+23*x^3*y^4+x^2*y^5+7*x^2*y^2-7*x^3-29*x^2*y, x*y^2-x^2-4*x*y,[128X[104X
    [4X[28X  x^2*y^3+23*x*y^4+y^5-y ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, h, 5 );[127X[104X
    [4X[28X[ -x*y^5+x^2*y^3+4*x*y^4+x^2*y^2, 0, 1][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, h, 4 );[127X[104X
    [4X[28X[ x^3*y^4+23*x^3*y^3+93*x^2*y^4+4*x*y^5+23*x^3*y^2+x^2*y^3-x*y^2+7*x^2, x,[128X[104X
    [4X[28X  23*x+y ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, h, 3 );[127X[104X
    [4X[28X[ x^4*y^3+23*x^3*y^4+x^2*y^5+x^4*y^2+23*x^3*y^3+x^2*y^4-x*y^3+7*x^2*y+[128X[104X
    [4X[28X  4*x*y^2-28*x^2, x*y-4*x, x^2+23*x*y+y^2 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, h, 2 );[127X[104X
    [4X[28X[ x^4*y^3+23*x^3*y^4+x^2*y^5-x*y^4+8*x^2*y^2+4*x*y^3-7*x^3-28*x^2*y,[128X[104X
    [4X[28X  x*y^2-x^2-4*x*y, x^2*y+23*x*y^2+y^3 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, h, 1 );[127X[104X
    [4X[28X[ 0, 0, 0 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, h, 0 );[127X[104X
    [4X[28X[ 0, 0, 0 ][128X[104X
    [4X[25Xgap>[125X [27XSuslinLemma( f, G, 1 );[127X[104X
    [4X[28X[ x^4*y^2+23*x^3*y^3+x^2*y^4+2*x^2*y^3+46*x*y^4+2*y^5+7*x^2*y-29*x^2-2*y,[128X[104X
    [4X[28X  x*y-4*x, x^2*y^2+23*x*y^3+y^4-1 ][128X[104X
  [4X[32X[104X
  
  [1X1.1-2 SuslinLemma[101X
  
  [33X[1;0Y[29X[2XSuslinLemma[102X( [3Xrow[103X, [3Xpos_f[103X, [3Xpos_g[103X, [3Xj[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ya list[133X
  
  [33X[0;0YReturns a list of 5 objects: [ [3Xrow[103X * [10XT[110X, [10XT[110X, [10XTI[110X, [10Xpos_h[110X, [10Xbj[110X ].[133X
  [33X[0;0Y[10XT[110X  is  a square transformation matrix which transforms [10Xpos_h[110X-th entry of the
  [3Xrow[103X  to  the  linear  combination  of  the monic entry [22Xf[122X and [22Xg[122X (at [3Xpos_f[103X and
  [3Xpos_g[103X-th  positions,  respectively)  with leading coefficient being the [3Xj[103X-th
  coefficient [10Xbj[110X of [22Xg[122X and [10XTI[110X is the inverse matrix of [10XT[110X.[133X
  [33X[0;0Y[22Xf[122X has to be monic and [10Xbj[110X is a unit.[133X
  [33X[0;0YThe  corresponding  method should make use of the three argument [2XSuslinLemma[102X
  ([14X1.1-1[114X).[133X
  
  [4X[32X  Code  [32X[104X
    [4XInstallMethod( SuslinLemma,[104X
    [4X        "for a homalg matrix and three integers",[104X
    [4X        [ IsHomalgMatrix, IsInt, IsInt, IsInt ],[104X
    [4X<P/>[104X
    [4X  function( row, pos_f, pos_g, j )[104X
    [4X    local c, bool_inv, f, g, bj, pos_h, h, deg_h, e, af, ag, lc, a, R, T, TI;[104X
    [4X<P/>[104X
    [4X    Info( InfoQuillenSuslin, 4, "Entering SuslinLemma for row" );[104X
    [4X<P/>[104X
    [4X    if not NrRows( row ) = 1 then[104X
    [4X        Error( "Number of rows should be 1\n" );[104X
    [4X    fi;[104X
    [4X<P/>[104X
    [4X    c := NrColumns( row );[104X
    [4X<P/>[104X
    [4X    if c < 3 then[104X
    [4X        Error( "the row has less than three columns\n" );[104X
    [4X    fi;[104X
    [4X<P/>[104X
    [4X    if HasIsRightInvertibleMatrix( row ) then[104X
    [4X        bool_inv := IsRightInvertibleMatrix( row );[104X
    [4X    fi;[104X
    [4X<P/>[104X
    [4X    f := row[ 1, pos_f ];[104X
    [4X    g := row[ 1, pos_g ];[104X
    [4X<P/>[104X
    [4X    bj := CoefficientOfUnivariatePolynomial( g, j );[104X
    [4X<P/>[104X
    [4X    Assert( 4, IsUnit( bj ) ); ## in the local base ring[104X
    [4X<P/>[104X
    [4X    pos_h := First( [ 1 .. c ], i -> not i in [ pos_f, pos_g ] );[104X
    [4X    h := row[ 1, pos_h ];[104X
    [4X<P/>[104X
    [4X    deg_h := Degree( h );[104X
    [4X<P/>[104X
    [4X    Assert( 0, deg_h < Degree( f ) and not IsMonic( h ) );[104X
    [4X<P/>[104X
    [4X    e := SuslinLemma( f, g, j );[104X
    [4X<P/>[104X
    [4X    af := e[2];[104X
    [4X    ag := e[3];[104X
    [4X    e := e[1];[104X
    [4X<P/>[104X
    [4X    Assert( 4, LeadingCoefficient( e ) = bj );[104X
    [4X<P/>[104X
    [4X    if deg_h < Degree( f ) - 1 then[104X
    [4X        a := bj^-1;[104X
    [4X    else[104X
    [4X        lc := LeadingCoefficient( h );[104X
    [4X        a := ( 1 - lc ) * bj^-1;[104X
    [4X    fi;[104X
    [4X<P/>[104X
    [4X    R := HomalgRing( row );[104X
    [4X    T := HomalgInitialIdentityMatrix( c, R );[104X
    [4X    TI := HomalgInitialIdentityMatrix( c, R );[104X
    [4X<P/>[104X
    [4X    T[ pos_f, pos_h ] := a * af;[104X
    [4X    T[ pos_g, pos_h ] := a * ag;[104X
    [4X<P/>[104X
    [4X    TI[ pos_f, pos_h ] := -a * af;[104X
    [4X    TI[ pos_g, pos_h ] := -a * ag;[104X
    [4X<P/>[104X
    [4X    MakeImmutable( T );[104X
    [4X    MakeImmutable( TI );[104X
    [4X<P/>[104X
    [4X    Assert( 4, IsOne( T * TI ) );[104X
    [4X<P/>[104X
    [4X    row := row * T;[104X
    [4X<P/>[104X
    [4X    if IsBound( bool_inv ) then[104X
    [4X        ## We cannot algorithmically verify the line below.[104X
    [4X        ## TODO: should become obsolete with ToDo-lists in MatricesForHomalg.[104X
    [4X        SetIsRightInvertibleMatrix( row, bool_inv );[104X
    [4X    fi;[104X
    [4X<P/>[104X
    [4X    Info( InfoQuillenSuslin, 4, "Leaving SuslinLemma for row" );[104X
    [4X<P/>[104X
    [4X    return [ row, T, TI, pos_h, bj ];[104X
    [4X<P/>[104X
    [4Xend );[104X
  [4X[32X[104X
  
  [33X[0;0YContinuing of the previous example:[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27Xrow := HomalgMatrix( [ h, G, f, g + h ], 1, 4, R );;[127X[104X
    [4X[25Xgap>[125X [27Xsus := SuslinLemma( row, 3, 2, 1 );[127X[104X
    [4X[28X[ <An unevaluated 1 x 4 matrix over an external ring>,[128X[104X
    [4X[28X  <A 4 x 4 matrix over an external ring>, <A 4 x 4 matrix over an external ring>,[128X[104X
    [4X[28X  1, 2 ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( sus[1] );[127X[104X
    [4X[28X[ 1/2*x^5*y^2+23/2*x^4*y^3+1/2*x^3*y^4+1/2*x^4*y^2+25/2*x^3*y^3+47/2*x^2*y^4+[128X[104X
    [4X[28X  2*x^2*y^3+27*x*y^4+y^5+7/2*x^3*y+x^2*y^2-29/2*x^3+7/2*x^2*y-29/2*x^2-x*y-y, [128X[104X
    [4X[28X  -x*y^3+4*x*y^2+x^2+2*y, x^2*y^4+23*x*y^5+y^6-y^2+7*x, -x*y^5+x^2*y^3+4*x*y^4+[128X[104X
    [4X[28X  x^2*y^2-x*y^3+x^2*y+4*x*y^2+x^2 ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( sus[2] );[127X[104X
    [4X[28X[ 1, 0, 0, 0, 1/2*x^3*y^2+23/2*x^2*y^3+1/2*x*y^4+1/2*x^2*y^2+23/2*x*y^3+[128X[104X
    [4X[28X  1/2*y^4-1/2*x-1/2, 1, 0, 0, 1/2*x^2*y-2*x^2+1/2*x*y-2*x, 0, 1, 0, 0, 0, 0, 1 ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( sus[3] );[127X[104X
    [4X[28X[ 1, 0, 0, 0, -1/2*x^3*y^2-23/2*x^2*y^3-1/2*x*y^4-1/2*x^2*y^2-23/2*x*y^3-1/2*y^4+[128X[104X
    [4X[28X  1/2*x+1/2, 1, 0, 0, -1/2*x^2*y+2*x^2-1/2*x*y+2*x, 0, 1, 0, 0, 0, 0, 1 ][128X[104X
  [4X[32X[104X
  
  [1X1.1-3 Horrocks[101X
  
  [33X[1;0Y[29X[2XHorrocks[102X( [3Xrow[103X, [3Xo[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ya list[133X
  
  [33X[0;0YReturns a list of two matrices: [ [10XT[110X, [10XTI[110X ].[133X
  [33X[0;0Y[10XT[110X  is a square transformation matrix which transforms [3Xrow[103X to unit row. [10XTI[110X is
  the inverse matrix of [10XT[110X.[133X
  [33X[0;0Y[3Xrow[103X  is  a unimodular matrix with at least 3 entries in which the [3Xo[103X-th entry
  is monic.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XQ := HomalgFieldOfRationalsInSingular( );;[127X[104X
    [4X[25Xgap>[125X [27XR := ( Q * "x" ) * "y";[127X[104X
    [4X[28XQ[x][y][128X[104X
    [4X[25Xgap>[125X [27Xrow := HomalgMatrix( "[ x^2, y+1/2, x^5*y^2+y ]", 1, 3, R );[127X[104X
    [4X[28X<A 1 x 3 matrix over an external ring>[128X[104X
    [4X[25Xgap>[125X [27XIsRightInvertibleMatrix( row );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27Xm1 := AMaximalIdealContaining( ZeroLeftSubmodule( BaseRing( R ) ) );;[127X[104X
    [4X[25Xgap>[125X [27Xm1 := EntriesOfHomalgMatrix( MatrixOfSubobjectGenerators( m1 ) );;[127X[104X
    [4X[25Xgap>[125X [27XS1 := LocalizeBaseRingAtPrime( R, m1 );[127X[104X
    [4X[28X( Q[x]_< x > )[y][128X[104X
    [4X[25Xgap>[125X [27Xrow1 := S1 * row;[127X[104X
    [4X[28X<A 1 x 3 matrix over a (fake) local ring>[128X[104X
    [4X[25Xgap>[125X [27XIsRightInvertibleMatrix( row1 );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XH1 := Horrocks( row1, 2 );[127X[104X
    [4X[28X[ <An unevaluated 3 x 3 matrix over a (fake) local ring>,[128X[104X
    [4X[28X  <An unevaluated 3 x 3 matrix over a (fake) local ring> ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( H1[1] );[127X[104X
    [4X[28X[ 1, -y-1/2, (-x^5+2)/4, (4*x^7-4*x^5)/(x^5-2)*y+(-2*x^2+2), [128X[104X
    [4X[28X  (-4*x^7+4*x^5)/(x^5-2)*y^2+(-4*x^2+4)/(x^5-2)*y+(x^2), [128X[104X
    [4X[28X  (-x^7)*y+(x^7-2*x^2)/2, (-4*x^2+4)/(x^5-2), [128X[104X
    [4X[28X  (4*x^2-4)/(x^5-2)*y+(2*x^2-2)/(x^5-2), (x^2) ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( H1[2] );[127X[104X
    [4X[28X[ (x^2), y+1/2, (x^5)*y^2+y, 0, 1, (x^5)*y+(-x^5+2)/2, [128X[104X
    [4X[28X  (4*x^2-4)/(x^5-2), 0, 1 ][128X[104X
    [4X[25Xgap>[125X [27XDelta1 := Denominator( H1[1] ) / BaseRing( R );[127X[104X
    [4X[28Xx^5-2[128X[104X
    [4X[25Xgap>[125X [27Xm2 := AMaximalIdealContaining( LeftSubmodule( [ Delta1 ] ) );;[127X[104X
    [4X[25Xgap>[125X [27Xm2 := EntriesOfHomalgMatrix( MatrixOfSubobjectGenerators( m2 ) );;[127X[104X
    [4X[25Xgap>[125X [27XS2 := LocalizeBaseRingAtPrime( R, m2 );[127X[104X
    [4X[28X( Q[x]_< x^5-2 > )[y][128X[104X
    [4X[25Xgap>[125X [27Xrow2 := S2 * row;;[127X[104X
    [4X[25Xgap>[125X [27XIsRightInvertibleMatrix( row2 );[127X[104X
    [4X[28Xtrue[128X[104X
    [4X[25Xgap>[125X [27XH2 := Horrocks( row2, 2 );[127X[104X
    [4X[28X[ <An unevaluated 3 x 3 matrix over a (fake) local ring>,[128X[104X
    [4X[28X  <An unevaluated 3 x 3 matrix over a (fake) local ring> ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( H2[1] );[127X[104X
    [4X[28X[ (x^5-2)/4, (x^5-6)/(4*x^2)*y+(x^5-6)/(8*x^2), (-x^5+6)/(4*x^2), [128X[104X
    [4X[28X  (x^7)*y+(-x^7+2*x^2)/2, (x^5)*y^2+y+(-x^5+6)/4, (-x^5)*y+(x^5-2)/2, [128X[104X
    [4X[28X  (-x^2), -y-1/2, 1 ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( H2[2] );[127X[104X
    [4X[28X[ 1, 0, (x^5-6)/(4*x^2), 0, 1, (x^5)*y+(-x^5+2)/2, (x^2), y+1/2, [128X[104X
    [4X[28X  (x^5)*y^2+y ][128X[104X
    [4X[25Xgap>[125X [27XDelta2 := Denominator( H2[1] ) / BaseRing( R );[127X[104X
    [4X[28X4*x^2[128X[104X
    [4X[25Xgap>[125X [27XI := LeftSubmodule( [ Delta1, Delta2 ] );;[127X[104X
    [4X[25Xgap>[125X [27XIsOne( I );[127X[104X
    [4X[28Xtrue[128X[104X
  [4X[32X[104X
  
  [1X1.1-4 Patch[101X
  
  [33X[1;0Y[29X[2XPatch[102X( [3Xrow[103X, [3XVs[103X, [3XVIs[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ya [5Xhomalg[105X matrix[133X
  
  [33X[0;0YReturns  a  square  matrix [3XV[103X over a univariate polynomial ring [22XR=B[y][122X over a
  (polynomial) base ring [22XB[122X, such that [3Xrow[103X*[10XV[110X is equal to [3Xrow[103X with [22Xy[122X set to [22X0[122X.[133X
  [33X[0;0YThe arguments [3XVs[103X and [3XVIs[103X are lists of matrices obtained from [10XHorrocks[110X over a
  localization of [22XR[122X defined by various maximal ideals of [22XB[122X.[133X
  [33X[0;0Y[3XVIs[103X[22X[j][122X  is the inverse of [3XVs[103X[22X[j][122X. The denominators of [3XVs[103X[22X[j][122X must generate the
  unit ideal of [22XB[122X.[133X
  
  [4X[32X  Example  [32X[104X
    [4X[25Xgap>[125X [27XV := Patch( row, [ H1[1], H2[1] ], [ H1[2], H2[2] ] );[127X[104X
    [4X[28X<A 3 x 3 matrix over an external ring>[128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( V );[127X[104X
    [4X[28X[ 1, 1/8*x^8*y+1/2*x^5*y-3/4*x^3*y-y, [128X[104X
    [4X[28X  -1/16*x^13*y-1/4*x^10*y+1/2*x^8*y+x^5*y-3/4*x^3*y-y, 0, [128X[104X
    [4X[28X  1/2*x^10*y^2-1/4*x^10*y+2*x^7*y^2-x^7*y-2*x^5*y^2+3/2*x^5*y+2*x^2*y-\[128X[104X
    [4X[28X2*y+1, [128X[104X
    [4X[28X  -1/4*x^15*y^2+1/8*x^15*y-x^12*y^2+1/2*x^12*y+3/2*x^10*y^2-x^10*y+2*x\[128X[104X
    [4X[28X^7*y^2-2*x^7*y-2*x^5*y^2+3/2*x^5*y+2*x^2*y-2*y, 0, [128X[104X
    [4X[28X  -1/2*x^5*y-2*x^2*y+2*y, 1/4*x^10*y+x^7*y-3/2*x^5*y-2*x^2*y+2*y+1 ][128X[104X
    [4X[25Xgap>[125X [27XEntriesOfHomalgMatrix( row * V );[127X[104X
    [4X[28X[ x^2, 1/2, 0 ][128X[104X
    [4X[25Xgap>[125X [27Xy := RelativeIndeterminatesOfPolynomialRing( R )[1];;[127X[104X
    [4X[25Xgap>[125X [27Xrow * V = Value( row, y, Zero( y ) );[127X[104X
    [4X[28Xtrue[128X[104X
  [4X[32X[104X
  
  
  [1X1.2 [33X[0;0YMain procedures[133X[101X
  
  [1X1.2-1 QuillenSuslinUnipotent[101X
  
  [33X[1;0Y[29X[2XQuillenSuslinUnipotent[102X( [3Xmat[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ya list of two [5Xhomalg[105X matrices[133X
  
  [33X[0;0YCompute  for  the  [22Xr × c[122X-matrix [3Xmat[103X a square matrix [22XV[122X such that [3Xmat[103X [22X* V[122X is a
  lower unipotent matrix.[133X
  
  [1X1.2-2 QuillenSuslin[101X
  
  [33X[1;0Y[29X[2XQuillenSuslin[102X( [3Xmat[103X ) [32X operation[133X
  [6XReturns:[106X  [33X[0;10Ya [5Xhomalg[105X matrix[133X
  
  [33X[0;0YFor  the given [22Xr × c[122X-matrix [3Xmat[103X, compute a square matrix [22XV[122X such that [3Xmat[103X [22X* V[122X
  is equal to the first [22Xr[122X rows of the [22Xc × c[122X identity matrix.[133X
  
